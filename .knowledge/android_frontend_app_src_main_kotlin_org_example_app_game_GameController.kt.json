{"is_source_file": true, "format": "Kotlin", "description": "This file defines the `GameController` class that manages user interaction, game state updates, move history, AI moves, and UI updates for a chess game Android application.", "external_files": ["org.example.app.ai.BasicAi", "org.example.app.chess.*", "org.example.app.ui.MoveRow"], "external_methods": ["Rules.legalMoves", "Rules.isInCheck", "Notation.sanForMove", "GameState.reset", "GameState.undoSmart", "Square", "toSquare", "toIndex"], "published": ["currentBoard", "currentHighlights", "historyPairs", "flipBoard", "modeText", "toggleMode", "reset", "undo", "onSquareTapped", "forceAiMove"], "classes": [{"name": "GameController", "description": "Controller class managing user interactions, game state, move execution, AI integration, and UI updates for a chess game."}], "methods": [{"name": "currentBoard", "description": "Returns the current game board."}, {"name": "currentHighlights", "description": "Calculates and returns highlights such as selected square, legal move targets, last move, and check status."}, {"name": "historyPairs", "description": "Returns the move history as a list of move rows for UI display."}, {"name": "flipBoard", "description": "Flips the board orientation."}, {"name": "modeText", "description": "Returns a string indicating whether AI is on or off."}, {"name": "toggleMode", "description": "Toggles between Human vs AI and Pass-and-Play modes."}, {"name": "reset", "description": "Resets the game state and UI."}, {"name": "undo", "description": "Undoes the last move."}, {"name": "onSquareTapped", "description": "Handles tap events on a board square, selecting or moving pieces."}, {"name": "forceAiMove", "description": "Triggers AI to make a move if in AI mode."}, {"name": "makeMove", "description": "Executes a move, updates game state and UI, and initiates AI move if applicable."}, {"name": "maybeStartAiMove", "description": "Starts an AI move asynchronously if the game mode and turn conditions are met."}, {"name": "toIndex", "description": "Converts a `Square` to a board index."}, {"name": "toSquare", "description": "Converts a board index to a `Square`."}], "calls": ["Rules.legalMoves", "Rules.isInCheck", "Notation.sanForMove", "state.board.clone", "state.applyMove", "BasicAi.chooseMove", "scope.launch", "onDisableInput", "onEnableInput", "onUiUpdate"], "search-terms": ["GameController", "AI move", "move validation", "user interaction", "chess game", "Android Kotlin", "UI update", "move history"], "state": 2, "file_id": 26, "knowledge_revision": 53, "git_revision": "", "hash": "7b8887d649aa75e4f0d5797c7c1d054f", "format-version": 4, "code-base-name": "android_frontend", "filename": "android_frontend/app/src/main/kotlin/org/example/app/game/GameController.kt", "revision_history": [{"53": ""}]}